<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <title>百城千园行</title>
    <!-- <link rel="stylesheet" type="text/css" href= "{{ url_for('static', filename = 'mymain.css') }}"> -->
    <link rel="stylesheet" type="text/css" href="/static/mymain.css?v=05241036">

</head>
<body>
    <div class="background"></div>
    <div class="title">
        <img class="logo" src="../static/百城千园行.png"/>
        <a class="head-text">
            <div class="head-text-main">工赋园区·数智未来</div>
            <div class="head-text-sub">百城千园行-张家口站</div>
        </a>
    </div>

    {% if openid %}
    <div class="weather">
        <a class="weather-text">签到成功！欢迎您，{{name}}</a>
    </div>
    <div class="maintext">
        * 活动
        <div class="maintext-sub">京津冀工业互联网协同发展示范区供需对接活动暨工业互联网一体化进园区“百城千园行”张家口站启动仪式</div>
    </div>
    <div class="maintext">
        * 时间
        <div class="maintext-sub">2023.5.29-2023.5.30</div>
    </div>
    <div class="maintext">
        * 地点
        <div class="maintext-sub">张家口国际大酒店、南山汽车产业基地、东山产业集聚区、空港经济开发区</div>
    </div>
    <div class="maintext">
        * 主题
        <div class="maintext-sub">工赋园区·数智未来</div>
    </div>

    <!-- <div class="hang1">
        <div class="shijian" onclick="toShijian();">会议安排</div> 
        <div class="dingcan" onclick="toDingcan();">酒店订餐</div>
    </div> -->
    <div class="floating-buttons">
        <!-- <a href="#" class="floating-button" style="font-weight: bold;border-style: inset;background-color: #5698c3;color: aliceblue;">主页</a> -->
        <a href="#" class="floating-button" onclick="toShijian();">会议安排</a>
        <a href="#" class="floating-button" onclick="toDingcan();">酒店订餐</a>
    </div>
    {% else %}
    <div class="loading">
        <!-- <img src="../static/liantong.png" style="height: 36px;"/> -->
        <div class="loading-sub">登录中……</div>
    </div>
    {% endif %}

    <footer>
        <div class="container">
          <div class="content">
            <p>Copyright©2023  河北联通  提供技术支持</p>
            <img src="../static/liantong.png"/>
            <!-- <p>Technical support: support@yourcompany.com</p> -->
          </div>
        </div>
      </footer>



<script src="/static/jquery.min.js"></script>
<script language="JavaScript">

    const redirectToAuthPage = () => {
        const callbackURL = encodeURIComponent(`https://wxapp.wind-watcher.cn/login`)
        const state = encodeURIComponent('')
        const wechatId = 'wxcd05e9f3d5d1f7bf'
        const redirectURI = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${wechatId}&redirect_uri=${callbackURL}&response_type=code&scope=snsapi_base&state=${state}#wechat_redirect`
        // console.log(redirectURI)
        window.location.href = redirectURI
        
    }
    var openid = "{{openid}}"
    if(!openid){
        redirectToAuthPage()
    }
    
    function toShijian(){
        window.location.href = "/timeanpai/"+openid;
    };
    function toDingcan(){
        window.location.href = "/dingcan/"+openid;
    };



    // $(function() {
    // 	if (window.history && window.history.pushState) {
    // 		$(window).on('popstate', function () {
    // 			window.history.pushState('forward', null, '#');
    // 			window.history.forward(1);
    // 		});
    // 	}
    //     window.history.pushState('forward', null, '#'); //在IE中必须得有这两行
    //     window.history.forward(1);
    // });

    // jQuery(document).ready(function ($) {
	//     if (window.history && window.history.pushState) {
	// 		$(window).on('popstate', function () {
	// 			window.history.forward(1);
	// 		});
  	// 	}
    // });
    document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
        WeixinJSBridge.call('hideToolbar');
    });
    history.pushState(null, null, document.URL); //禁止网页返回上一页
    window.addEventListener('popstate', function() { 
    history.pushState(null, null, document.URL); 
    });
    sessionStorage.setItem('key', 1);　　　　　　 pushHistory();
        window.addEventListener("popstate", function (e) {
            if(sessionStorage.getItem('key') != 1) {
                sessionStorage.setItem('key', 1);
            }
            if(sessionStorage.getItem('key') == 1) {
                document.addEventListener('WeixinJSBridgeReady', function(){ WeixinJSBridge.call('closeWindow'); }, false);
                WeixinJSBridge.call('closeWindow');
                parent.WeixinJSBridge.call('closeWindow');//网上有人认为微信内置浏览器和本地开发测试的环境不一样，微信内部是采用iframe方式加载页面的（暂未得到考证），所以我采用了两种方式都写的兼容写法
            }

        }, false);
        function pushHistory() {
            var state = {
                title: "title",
                url: "#"
            };
            window.history.pushState(state, "title", "#");
        }


    
</script>
</body>
</html>
